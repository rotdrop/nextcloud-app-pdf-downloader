{"version":3,"file":"js/chunks/src_views_FilesTab_vue-cdb0d854a3d443f6d2b2.js","mappings":"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","sources":["webpack://pdf-downloader/./src/views/FilesTab.vue","webpack://pdf-downloader/./src/components/mixins/unclipped-popup.js","webpack://pdf-downloader/./src/toolkit/util/generate-url.js","webpack://pdf-downloader/./src/toolkit/util/jquery.js","webpack://pdf-downloader/./src/toolkit/util/print-r.js","webpack://pdf-downloader/./src/toolkit/util/dialogs.js","webpack://pdf-downloader/./src/toolkit/util/ajax.js","webpack://pdf-downloader/./src/toolkit/util/file-download.js","webpack://pdf-downloader/src/views/FilesTab.vue","webpack://pdf-downloader/./src/views/FilesTab.vue?8640","webpack://pdf-downloader/./src/toolkit/util/file-node-helper.js","webpack://pdf-downloader/./src/views/FilesTab.vue?3e00"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"files-tab\"},[_c('ul',[_c('li',{staticClass:\"files-tab-entry flex flex-center clickable\"},[_c('div',{staticClass:\"files-tab-entry__avatar icon-play-white\",on:{\"click\":function($event){$event.preventDefault();$event.stopPropagation();return _vm.toggleDownloadMenu.apply(null, arguments)}}}),_vm._v(\" \"),_c('div',{staticClass:\"files-tab-entry__desc\",on:{\"click\":function($event){$event.preventDefault();$event.stopPropagation();return _vm.toggleDownloadMenu.apply(null, arguments)}}},[_c('h5',[_c('span',{staticClass:\"main-title\"},[_vm._v(_vm._s(_vm.t(_vm.appName, 'Generate PDF')))])])]),_vm._v(\" \"),_c('NcActions',{ref:\"downloadActions\"},[_c('NcActionButton',{attrs:{\"icon\":\"icon-download\",\"disabled\":_vm.downloading},on:{\"click\":function($event){$event.preventDefault();$event.stopPropagation();return _vm.handleDownload.apply(null, arguments)}}},[_vm._v(\"\\n          \"+_vm._s(_vm.t(_vm.appName, 'download locally'))+\"\\n        \")]),_vm._v(\" \"),_c('NcActionButton',{attrs:{\"model-value\":_vm.showCloudDestination,\"disabled\":_vm.showCloudDestination},on:{\"update:modelValue\":function($event){_vm.showCloudDestination=$event},\"update:model-value\":function($event){_vm.showCloudDestination=$event},\"click\":function($event){$event.preventDefault();$event.stopPropagation();_vm.showCloudDestination = !_vm.showCloudDestination}},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('CloudUpload',{attrs:{\"size\":16,\"decorative\":\"\",\"title\":\"\"}})]},proxy:true}])},[_vm._v(\"\\n          \"+_vm._s(_vm.t(_vm.appName, 'save to cloud'))+\"\\n        \")])],1)],1),_vm._v(\" \"),_c('li',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showCloudDestination),expression:\"showCloudDestination\"}],staticClass:\"directory-chooser files-tab-entry\"},[_c('FilePrefixPicker',{attrs:{\"hint\":_vm.t(_vm.appName, 'Choose a destination in the cloud:'),\"placeholder\":_vm.t(_vm.appName, 'basename'),\"readonly\":_vm.downloadOptions.useTemplate ? 'basename' : false,\"disabled\":_vm.downloading},on:{\"update\":() => _vm.handleSaveToCloud()},model:{value:(_vm.cloudDestinationFileInfo),callback:function ($$v) {_vm.cloudDestinationFileInfo=$$v},expression:\"cloudDestinationFileInfo\"}})],1),_vm._v(\" \"),_c('li',{staticClass:\"files-tab-entry flex flex-center clickable\"},[_c('div',{staticClass:\"files-tab-entry__avatar icon-settings-white\",on:{\"click\":_vm.toggleOptionsMenu}}),_vm._v(\" \"),_c('div',{staticClass:\"files-tab-entry__desc\",on:{\"click\":_vm.toggleOptionsMenu}},[_c('h5',[_c('span',{staticClass:\"main-title\"},[_vm._v(_vm._s(_vm.t(_vm.appName, 'Options')))])])]),_vm._v(\" \"),_c('NcActions',{ref:\"downloadOptions\"},[_c('NcActionCheckbox',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.tooltips.pageLabels),expression:\"tooltips.pageLabels\"}],attrs:{\"checked\":!!_vm.downloadOptions.pageLabels},on:{\"update:checked\":(value) => _vm.downloadOptions.pageLabels = value}},[_vm._v(\"\\n          \"+_vm._s(_vm.t(_vm.appName, 'page labels'))+\"\\n        \")]),_vm._v(\" \"),_c('NcActionCheckbox',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.tooltips.useTemplate),expression:\"tooltips.useTemplate\"}],attrs:{\"checked\":!!_vm.downloadOptions.useTemplate},on:{\"update:checked\":(value) => _vm.downloadOptions.useTemplate = value}},[_vm._v(\"\\n          \"+_vm._s(_vm.t(_vm.appName, 'filename template'))+\"\\n        \")]),_vm._v(\" \"),_c('NcActionCheckbox',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.tooltips.offline),expression:\"tooltips.offline\"}],attrs:{\"checked\":!!_vm.downloadOptions.offline},on:{\"update:checked\":(value) => _vm.downloadOptions.offline = value}},[_vm._v(\"\\n          \"+_vm._s(_vm.t(_vm.appName, 'offline'))+\"\\n        \")])],1)],1),_vm._v(\" \"),_c('li',{staticClass:\"files-tab-entry flex flex-center clickable\"},[_c('div',{staticClass:\"files-tab-entry__avatar icon-download-white\",on:{\"click\":function($event){_vm.showBackgroundDownloads = !_vm.showBackgroundDownloads}}}),_vm._v(\" \"),_c('div',{staticClass:\"files-tab-entry__desc\",on:{\"click\":function($event){_vm.showBackgroundDownloads = !_vm.showBackgroundDownloads}}},[_c('h5',[_vm._v(_vm._s(_vm.t(_vm.appName, 'Offline Downloads')))])]),_vm._v(\" \"),_c('NcActions',[_c('NcActionButton',{attrs:{\"model-value\":_vm.showBackgroundDownloads,\"icon\":'icon-triangle-' + (_vm.showBackgroundDownloads ? 'n' : 's')},on:{\"update:modelValue\":function($event){_vm.showBackgroundDownloads=$event},\"update:model-value\":function($event){_vm.showBackgroundDownloads=$event},\"click\":function($event){$event.preventDefault();$event.stopPropagation();_vm.showBackgroundDownloads = !_vm.showBackgroundDownloads}}})],1)],1),_vm._v(\" \"),_c('li',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showBackgroundDownloads),expression:\"showBackgroundDownloads\"}],staticClass:\"files-tab-entry\"},[(_vm.loading)?_c('div',{staticClass:\"icon-loading-small\"}):(_vm.downloads.length === 0)?_c('div',{staticClass:\"flex flex-center justify-center\"},[_c('span',{staticClass:\"label\"},[_vm._v(\"\\n          \"+_vm._s(_vm.t(_vm.appName, 'No Downloads Yet'))+\"\\n        \")]),_vm._v(\" \"),_c('NcActions',[_c('NcActionButton',{attrs:{\"icon\":\"icon-play\"},on:{\"click\":function($event){$event.preventDefault();$event.stopPropagation();return _vm.refreshAvailableDownloads.apply(null, arguments)}}},[_vm._v(\"\\n            \"+_vm._s(_vm.t(_vm.appName, 'refresh'))+\"\\n          \")])],1)],1):_c('ul',_vm._l((_vm.downloads),function({fileid, basename}){return _c('li',{key:fileid,staticClass:\"flex flex-center flex-wrap\"},[_c('a',{staticClass:\"download external flex-grow\",attrs:{\"href\":_vm.downloadUrl(fileid),\"download\":\"\"},on:{\"click\":function($event){$event.preventDefault();$event.stopPropagation();return _vm.handleCacheFileDownload(fileid)}}},[_vm._v(\"\\n            \"+_vm._s(basename)+\"\\n          \")]),_vm._v(\" \"),_c('NcActions',{staticClass:\"flex-no-grow flex-no-shrink\"},[_c('NcActionButton',{on:{\"click\":function($event){$event.preventDefault();$event.stopPropagation();return _vm.handleCacheFileSave(fileid)}},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('CloudUpload',{attrs:{\"size\":16,\"decorative\":\"\",\"title\":\"\"}})]},proxy:true}],null,true)},[_vm._v(\"\\n              \"+_vm._s(_vm.t(_vm.appName, 'save to cloud'))+\"\\n            \")]),_vm._v(\" \"),_c('NcActionButton',{attrs:{\"icon\":\"icon-download\",\"disabled\":_vm.downloading},on:{\"click\":function($event){$event.preventDefault();$event.stopPropagation();return _vm.handleCacheFileDownload(fileid)}}},[_vm._v(\"\\n              \"+_vm._s(_vm.t(_vm.appName, 'download locally'))+\"\\n            \")]),_vm._v(\" \"),_c('NcActionButton',{attrs:{\"icon\":\"icon-delete\",\"disabled\":_vm.downloading},on:{\"click\":function($event){$event.preventDefault();$event.stopPropagation();return _vm.handleCacheFileDelete(fileid)}}},[_vm._v(\"\\n              \"+_vm._s(_vm.t(_vm.appName, 'delete PDF file'))+\"\\n            \")])],1)],1)}),0)])])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/**\n * @copyright Copyright (c) 2022, 2024 Claus-Justus Heine <himself@claus-justus-heine.de>\n * @author Claus-Justus Heine <himself@claus-justus-heine.de>\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/*\n<style lang=\"scss\">\n[csstag=\"vue-tooltip-unclipped-popup\"].v-popper--theme-tooltip {\n  .v-popper__inner {\n    max-width:unset!important;\n  }\n}\n*/\n\nexport default {\n  methods: {\n    unclippedPopup(content, html) {\n      return {\n        content,\n        preventOverflow: true,\n        html: true,\n        // shown: true,\n        // triggers: [],\n        csstag: ['vue-tooltip-unclipped-popup'],\n      };\n    },\n  },\n};\n","/**\n * @copyright Copyright (c) 2022, 2023, 2024 Claus-Justus Heine <himself@claus-justus-heine.de>\n *\n * @author Claus-Justus Heine <himself@claus-justus-heine.de>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { appName } from '../../config.js';\nimport { generateUrl as nextcloudGenerateUrl } from '@nextcloud/router';\n\n/**\n * Generate an absolute URL for this app.\n *\n * @param {string} url The locate URL without app-prefix.\n *\n * @param {object} urlParams Object holding url-parameters if url\n * contains parameters. \"Excess\" parameters will be appended as query\n * parameters to the URL.\n *\n * @param {object} [urlOptions] Object with query parameters\n * ```\n * {\n *   escape: BOOL,\n *   noRewrite: BOOL,\n * }\n * ```\n *\n * @return {string}\n */\nconst generateUrl = function(url, urlParams, urlOptions) {\n  // const str = '/image/{joinTable}/{ownerId}';\n  let generated = nextcloudGenerateUrl('/apps/' + appName + '/' + url, urlParams, urlOptions);\n  const queryParams = { ...urlParams };\n  for (const urlParam of url.matchAll(/{([^{}]*)}/g)) {\n    delete queryParams[urlParam[1]];\n  }\n  const queryArray = [];\n  for (const [key, value] of Object.entries(queryParams)) {\n    try {\n      queryArray.push(key + '=' + encodeURIComponent(value.toString()));\n    } catch (e) {\n      console.debug('STRING CONVERSION ERROR', e);\n    }\n  }\n  if (queryArray.length > 0) {\n    generated += '?' + queryArray.join('&');\n  }\n  return generated;\n};\n\nexport default generateUrl;\n","/**\n * @copyright Copyright (c) 2022, 2023 Claus-Justus Heine <himself@claus-justus-heine.de>\n *\n * @author Claus-Justus Heine <himself@claus-justus-heine.de>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n// jQuery stuff\n\nimport { appName } from '../../config.js';\nimport { getRequestToken, onRequestTokenUpdate } from '@nextcloud/auth';\nconst jQuery = require('jquery');\n\nif (window.jQuery && window.jQuery !== jQuery) {\n  console.info(appName + ': JQUERY VERSIONS W / A', window.jQuery.fn.jquery, jQuery.fn.jquery);\n  // if (window.jQuery.fn.jquery === jQuery.fn.jquery) {\n  //   console.info(appName + ': using matching window.jQuery version');\n  //   jQuery = window.jQuery;\n  // }\n}\n\nlet requestToken = getRequestToken() || '';\n\njQuery.ajaxSetup({\n  beforeSend(xhr) {\n    xhr.setRequestHeader('requesttoken', requestToken);\n  },\n});\n\nonRequestTokenUpdate(token => { requestToken = token; });\n\nexport default jQuery;\n","/**\n * @copyright Copyright (c) 2022 Claus-Justus Heine <himself@claus-justus-heine.de>\n * @author Claus-Justus Heine <himself@claus-justus-heine.de>\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n// eslint-disable-next-line camelcase\nconst print_r = function(array, returnVal, maxDepth) {\n  if (maxDepth === undefined) {\n    maxDepth = 5;\n  }\n  // discuss at: http://phpjs.org/functions/print_r/\n  // original by: Michael White (http://getsprink.com)\n  // improved by: Ben Bryan\n  // improved by: Brett Zamir (http://brett-zamir.me)\n  // improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\n  // input by: Brett Zamir (http://brett-zamir.me)\n  // depends on: echo\n  // example 1: print_r(1, true);\n  // returns 1: 1\n  let output = '';\n  const padChar = ' ';\n  const padVal = 4;\n  let d = window.document;\n  const getFuncName = function(fn) {\n    const name = (/\\W*function\\s+([\\w$]+)\\s*\\(/).exec(fn);\n    if (!name) {\n      return '(Anonymous)';\n    }\n    return name[1];\n  };\n  const repeatChar = function(len, padChar) {\n    let str = '';\n    for (let i = 0; i < len; i++) {\n      str += padChar;\n    }\n    return str;\n  };\n  const formatArray = function(obj, curDepth, padVal, padChar, maxDepth) {\n    if (curDepth > 0) {\n      curDepth++;\n    }\n    const basePad = repeatChar(padVal * curDepth, padChar);\n    const thickPad = repeatChar(padVal * (curDepth + 1), padChar);\n    let str = '';\n    if (typeof obj === 'object' && obj !== null && obj.constructor && getFuncName(obj.constructor)\n        !== 'PHPJS_Resource') {\n      const type = Object.prototype.toString.call(obj);\n      if (type === '[object Array]') {\n        str += 'Array\\n';\n      } else /* if (type == '[object Object]') */ {\n        str += 'Object\\n';\n      }\n      str += basePad + '(\\n';\n      for (const key in obj) {\n        const fieldType = Object.prototype.toString.call(obj[key]);\n        if (curDepth > maxDepth) {\n          str += thickPad + '[' + key + '] => ' + obj[key] + '\\n';\n        } else if (fieldType === '[object Array]') {\n          str += thickPad + '[' + key + '] => ' + formatArray(obj[key], curDepth + 1, padVal, padChar, maxDepth);\n        } else if (fieldType === '[object Object]') {\n          str += thickPad + '[' + key + '] => ' + formatArray(obj[key], curDepth + 1, padVal, padChar, maxDepth);\n        } else {\n          str += thickPad + '[' + key + '] => ' + obj[key] + '\\n';\n        }\n      }\n      str += basePad + ')\\n';\n    } else if (obj === null || obj === undefined) {\n      str = '';\n    } else {\n      // for our \"resource\" class\n      str = obj.toString();\n    }\n    return str;\n  };\n  output = formatArray(array, 0, padVal, padChar);\n  if (returnVal !== true) {\n    if (d.body) {\n      window.echo(output);\n    } else {\n      try {\n        // We're in XUL, so appending as plain text won't work; trigger an error out of XUL\n        // eslint-disable-next-line no-undef\n        d = XULDocument;\n        window.echo('<pre xmlns=\"http://www.w3.org/1999/xhtml\" style=\"white-space:pre;\">' + output + '</pre>');\n      } catch (e) {\n        // Outputting as plain text may work in some plain XML\n        window.echo(output);\n      }\n    }\n    return true;\n  }\n  return output;\n};\n\n// eslint-disable-next-line camelcase\nexport default print_r;\n\n// Local Variables: ***\n// js-indent-level: 2 ***\n// indent-tabs-mode: nil ***\n// End: ***\n","/**\n * @copyright Copyright (c) 2022, 2023 Claus-Justus Heine <himself@claus-justus-heine.de>\n * @author Claus-Justus Heine <himself@claus-justus-heine.de>\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport $ from './jquery.js';\nimport { appName } from '../../config.js';\n\nrequire('dialogs.scss');\n\nconst alert = function(text, title, callback, modal, allowHtml) {\n  return OC.dialogs.message(\n    text,\n    title,\n    'alert',\n    OC.dialogs.OK_BUTTON,\n    callback,\n    modal,\n    allowHtml,\n  );\n};\n\nconst info = function(text, title, callback, modal, allowHtml) {\n  return OC.dialogs.message(\n    text,\n    title,\n    'info',\n    OC.dialogs.OK_BUTTON,\n    callback,\n    modal,\n    allowHtml,\n  );\n};\n\nconst confirm = function(text, title, options, modal, allowHtml) {\n  const defaultOptions = {\n    callback() {},\n    modal: false,\n    allowHtml: false,\n    default: 'confirm',\n  };\n  if (typeof options === 'function') {\n    options = {\n      callback: options,\n      modal,\n      allowHtml,\n    };\n  }\n\n  let buttons;\n  if (options.default === 'cancel') {\n    buttons = {\n      type: OC.dialogs.YES_NO_BUTTONS,\n      confirm: t('core', 'No'),\n      cancel: t('core', 'Yes'),\n    };\n    const userCallback = options.callback;\n    options.callback = choice => userCallback(!choice);\n  } else {\n    buttons = OC.dialogs.YES_NO_BUTTONS;\n  }\n  options = $.extend({}, defaultOptions, options);\n  return OC.dialogs.message(\n    text,\n    title,\n    'notice',\n    buttons,\n    options.callback,\n    options.modal,\n    options.allowHtml,\n  );\n};\n\n/**\n * Popup a dialog with debug info if data.data.debug is set and non\n * empty.\n *\n * @param {object} data TBD.\n *\n * @param {Function} callback TBD.\n *\n */\nconst debugPopup = function(data, callback) {\n  if (typeof data.debug !== 'undefined' && data.debug !== '') {\n    if (typeof callback !== 'function') {\n      callback = undefined;\n    }\n    info(\n      '<div class=\"debug error contents\">' + data.debug + '</div>',\n      t(appName, 'Debug Information'),\n      callback, true, true);\n  }\n};\n\nconst filePicker = function(title, callback, multiselect, mimetypeFilter, modal, type, path, options) {\n  return OC.dialogs.filepicker(title, callback, multiselect, mimetypeFilter, modal, type, path, options);\n};\n\nconst attachDialogHandlers = function(container) {\n\n  const $container = $(container || 'body');\n\n  if ($container.data(appName + 'DialogHandlersAttached')) {\n    return;\n  }\n\n  $container.data(appName + 'DialogHandlersAttached', true);\n\n  $container\n    .off('dblclick', '.oc-dialog')\n    .on('dblclick', '.oc-dialog', function(event) {\n      $('.oc-dialog').toggleClass('maximize-width');\n      event.stopImmediatePropagation();\n    });\n\n  $container\n    .off('click', '.oc-dialog .exception.error.name')\n    .on('click', '.oc-dialog .exception.error.name', function(event) {\n      $(this).next().toggleClass('visible');\n      event.stopImmediatePropagation();\n    });\n\n  $container\n    .off('click', '.oc-dialog .error.exception ul.technical')\n    .on('click', '.oc-dialog .error.exception ul.technical', function(event) {\n      $(this).nextAll('.trace').toggleClass('visible');\n      event.stopImmediatePropagation();\n    });\n\n  $container\n    .off('click', '.oc-dialog .error.exception .trace.visible')\n    .on('click', '.oc-dialog .error.exception .trace.visible', function(event) {\n      const $this = $(this);\n      $this.removeClass('visible');\n      $this.next('.trace').removeClass('visible');\n      $this.prev('.trace').removeClass('visible');\n      event.stopImmediatePropagation();\n    });\n};\n\nexport {\n  alert,\n  info,\n  confirm,\n  debugPopup,\n  filePicker,\n  attachDialogHandlers,\n};\n\n// Local Variables: ***\n// js-indent-level: 2 ***\n// indent-tabs-mode: nil ***\n// End: ***\n","/**\n * @copyright Copyright (c) 2022, 2023 Claus-Justus Heine <himself@claus-justus-heine.de>\n * @author Claus-Justus Heine <himself@claus-justus-heine.de>\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport $ from './jquery.js';\nimport { appName } from '../../config.js';\n// eslint-disable-next-line camelcase\nimport print_r from './print-r.js';\nimport * as Dialogs from './dialogs.js';\nimport { isPlainObject } from 'is-plain-object';\nimport { getRootUrl as getCloudRootUrl } from '@nextcloud/router';\nimport { getInitialState } from '../services/InitialStateService.js';\n\nconst cloudWebRoot = getCloudRootUrl() || '/';\n\nconst globalState = getInitialState();\n\nconst ajaxHttpStatus = {\n  // TRANSLATORS: Textual description of HTTP status code 200, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  200: t(appName, 'OK'),\n  // TRANSLATORS: Textual description of HTTP status code 201, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  201: t(appName, 'Created'),\n  // TRANSLATORS: Textual description of HTTP status code 202, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  202: t(appName, 'Accepted'),\n  // TRANSLATORS: Textual description of HTTP status code 203, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  203: t(appName, 'Non-Authoritative Information'),\n  // TRANSLATORS: Textual description of HTTP status code 204, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  204: t(appName, 'No Content'),\n  // TRANSLATORS: Textual description of HTTP status code 205, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  205: t(appName, 'Reset Content'),\n  // TRANSLATORS: Textual description of HTTP status code 206, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  206: t(appName, 'Partial Content'),\n  // TRANSLATORS: Textual description of HTTP status code 207, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  207: t(appName, 'Multi-Status (WebDAV)'),\n  // TRANSLATORS: Textual description of HTTP status code 208, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  208: t(appName, 'Already Reported (WebDAV)'),\n  // TRANSLATORS: Textual description of HTTP status code 226, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  226: t(appName, 'IM Used'),\n  // TRANSLATORS: Textual description of HTTP status code 300, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  300: t(appName, 'Multiple Choices'),\n  // TRANSLATORS: Textual description of HTTP status code 301, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  301: t(appName, 'Moved Permanently'),\n  // TRANSLATORS: Textual description of HTTP status code 302, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  302: t(appName, 'Found'),\n  // TRANSLATORS: Textual description of HTTP status code 303, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  303: t(appName, 'See Other'),\n  // TRANSLATORS: Textual description of HTTP status code 304, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  304: t(appName, 'Not Modified'),\n  // TRANSLATORS: Textual description of HTTP status code 305, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  305: t(appName, 'Use Proxy'),\n  // TRANSLATORS: Textual description of HTTP status code 306, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  306: t(appName, '(Unused)'),\n  // TRANSLATORS: Textual description of HTTP status code 307, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  307: t(appName, 'Temporary Redirect'),\n  // TRANSLATORS: Textual description of HTTP status code 308, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  308: t(appName, 'Permanent Redirect (experimental)'),\n  // TRANSLATORS: Textual description of HTTP status code 400, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  400: t(appName, 'Bad Request'),\n  // TRANSLATORS: Textual description of HTTP status code 401, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  401: t(appName, 'Unauthorized'),\n  // TRANSLATORS: Textual description of HTTP status code 402, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  402: t(appName, 'Payment Required'),\n  // TRANSLATORS: Textual description of HTTP status code 403, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  403: t(appName, 'Forbidden'),\n  // TRANSLATORS: Textual description of HTTP status code 404, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  404: t(appName, 'Not Found'),\n  // TRANSLATORS: Textual description of HTTP status code 405, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  405: t(appName, 'Method Not Allowed'),\n  // TRANSLATORS: Textual description of HTTP status code 406, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  406: t(appName, 'Not Acceptable'),\n  // TRANSLATORS: Textual description of HTTP status code 407, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  407: t(appName, 'Proxy Authentication Required'),\n  // TRANSLATORS: Textual description of HTTP status code 408, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  408: t(appName, 'Request Timeout'),\n  // TRANSLATORS: Textual description of HTTP status code 409, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  409: t(appName, 'Conflict'),\n  // TRANSLATORS: Textual description of HTTP status code 410, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  410: t(appName, 'Gone'),\n  // TRANSLATORS: Textual description of HTTP status code 411, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  411: t(appName, 'Length Required'),\n  // TRANSLATORS: Textual description of HTTP status code 412, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  412: t(appName, 'Precondition Failed'),\n  // TRANSLATORS: Textual description of HTTP status code 413, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  413: t(appName, 'Request Entity Too Large'),\n  // TRANSLATORS: Textual description of HTTP status code 414, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  414: t(appName, 'Request-URI Too Long'),\n  // TRANSLATORS: Textual description of HTTP status code 415, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  415: t(appName, 'Unsupported Media Type'),\n  // TRANSLATORS: Textual description of HTTP status code 416, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  416: t(appName, 'Requested Range Not Satisfiable'),\n  // TRANSLATORS: Textual description of HTTP status code 417, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  417: t(appName, 'Expectation Failed'),\n  // TRANSLATORS: Textual description of HTTP status code 418, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  418: t(appName, 'I\\'m a teapot (RFC 2324)'),\n  // TRANSLATORS: Textual description of HTTP status code 420, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  420: t(appName, 'Enhance Your Calm (Twitter)'),\n  // TRANSLATORS: Textual description of HTTP status code 422, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  422: t(appName, 'Unprocessable Entity (WebDAV)'),\n  // TRANSLATORS: Textual description of HTTP status code 423, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  423: t(appName, 'Locked (WebDAV)'),\n  // TRANSLATORS: Textual description of HTTP status code 424, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  424: t(appName, 'Failed Dependency (WebDAV)'),\n  // TRANSLATORS: Textual description of HTTP status code 425, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  425: t(appName, 'Reserved for WebDAV'),\n  // TRANSLATORS: Textual description of HTTP status code 426, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  426: t(appName, 'Upgrade Required'),\n  // TRANSLATORS: Textual description of HTTP status code 428, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  428: t(appName, 'Precondition Required'),\n  // TRANSLATORS: Textual description of HTTP status code 429, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  429: t(appName, 'Too Many Requests'),\n  // TRANSLATORS: Textual description of HTTP status code 431, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  431: t(appName, 'Request Header Fields Too Large'),\n  // TRANSLATORS: Textual description of HTTP status code 444, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  444: t(appName, 'No Response (Nginx)'),\n  // TRANSLATORS: Textual description of HTTP status code 449, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  449: t(appName, 'Retry With (Microsoft)'),\n  // TRANSLATORS: Textual description of HTTP status code 450, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  450: t(appName, 'Blocked by Windows Parental Controls (Microsoft)'),\n  // TRANSLATORS: Textual description of HTTP status code 451, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  451: t(appName, 'Unavailable For Legal Reasons'),\n  // TRANSLATORS: Textual description of HTTP status code 599, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  499: t(appName, 'Client Closed Request (Nginx)'),\n  // TRANSLATORS: Textual description of HTTP status code 500, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  500: t(appName, 'Internal Server Error'),\n  // TRANSLATORS: Textual description of HTTP status code 501, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  501: t(appName, 'Not Implemented'),\n  // TRANSLATORS: Textual description of HTTP status code 502, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  502: t(appName, 'Bad Gateway'),\n  // TRANSLATORS: Textual description of HTTP status code 503, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  503: t(appName, 'Service Unavailable'),\n  // TRANSLATORS: Textual description of HTTP status code 504, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  504: t(appName, 'Gateway Timeout'),\n  // TRANSLATORS: Textual description of HTTP status code 505, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  505: t(appName, 'HTTP Version Not Supported'),\n  // TRANSLATORS: Textual description of HTTP status code 506, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  506: t(appName, 'Variant Also Negotiates (Experimental)'),\n  // TRANSLATORS: Textual description of HTTP status code 507, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  507: t(appName, 'Insufficient Storage (WebDAV)'),\n  // TRANSLATORS: Textual description of HTTP status code 508, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  508: t(appName, 'Loop Detected (WebDAV)'),\n  // TRANSLATORS: Textual description of HTTP status code 509, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  509: t(appName, 'Bandwidth Limit Exceeded (Apache)'),\n  // TRANSLATORS: Textual description of HTTP status code 510, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  510: t(appName, 'Not Extended'),\n  // TRANSLATORS: Textual description of HTTP status code 511, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  511: t(appName, 'Network Authentication Required'),\n  // TRANSLATORS: Textual description of HTTP status code 598, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  598: t(appName, 'Network read timeout error'),\n  // TRANSLATORS: Textual description of HTTP status code 599, see e.g. https://en.wikipedia.org/wiki/List_of_HTTP_status_codes\n  599: t(appName, 'Network connect timeout error'),\n\n  // Seemingly Nextcloud always ever only returns one of these:\n  OK: 200,\n  BAD_REQUEST: 400,\n  UNAUTHORIZED: 401,\n  NOT_FOUND: 404,\n  CONFLICT: 409,\n  PRECONDITION_FAILED: 412,\n  INTERNAL_SERVER_ERROR: 500,\n};\n\n/**\n * Generate some diagnostic output, mostly needed during application\n * development. This is intended to be called from the fail()\n * callback.\n *\n * @param {object} xhr TBD.\n *\n * @param {string} textStatus TBD.\n *\n * @param {number} errorThrown TBD.\n *\n * @param {object} callbacks An object with hook-functions:\n *\n * ```\n * {\n *   cleanup: function(data) { ... },\n *   preProcess: function(data) { ... }\n * ```\n *\n * The callbacks as well as the callback object itself is optional and\n * defaults to \"do nothing\". The argument is the data possibly\n * submitted by the server, as computed by ajaFailData().\n *\n * @return {object} TBD.\n */\nconst ajaxHandleError = function(xhr, textStatus, errorThrown, callbacks) {\n\n  const defaultCallbacks = {\n    cleanup(data) {},\n    preProcess(data) {},\n  };\n  callbacks = callbacks || {};\n  if (callbacks instanceof Function) {\n    callbacks = {\n      cleanup: callbacks,\n    };\n  }\n  callbacks = $.extend({}, defaultCallbacks, callbacks);\n\n  const failData = ajaxFailData(xhr, textStatus, errorThrown);\n  callbacks.preProcess(failData);\n\n  let decodedStatus;\n  switch (textStatus) {\n  case 'cancelled':\n    decodedStatus = t(appName, 'Operation cancelled by user.');\n    break;\n  case 'abort':\n    decodedStatus = t(appName, 'Aborted');\n    break;\n  case 'notmodified':\n  case 'nocontent':\n  case 'error':\n  case 'timeout':\n  case 'parsererror':\n  case 'success': // this should not happen here\n  default:\n    decodedStatus = ajaxHttpStatus[xhr.status];\n    break;\n  }\n\n  const caption = t(appName, 'Error');\n  let info = '<span class=\"bold toastify http-status error\">' + decodedStatus + '</span>';\n  // console.info(xhr.status, info, errorThrown, textStatus);\n\n  let autoReport = '<a href=\"mailto:'\n      + encodeURIComponent(globalState.adminContact)\n      + '?subject=' + '[Error] Error Feedback'\n      + '&body='\n      + encodeURIComponent(\n        'JavaScript User Agent:'\n          + '\\n'\n          + navigator.userAgent\n          + '\\n'\n          + '\\n'\n          + 'PHP User Agent:'\n          + '\\n'\n          + (globalState.phpUserAgent || 'unknown')\n          + '\\n'\n          + '\\n'\n          + 'Error Code: ' + decodedStatus\n          + '\\n'\n          + '\\n'\n          + 'Error Data: ' + print_r(failData, true)\n          + '\\n')\n      + '\">'\n      + t(appName, 'System Administrator')\n      + '</a>';\n\n  switch (xhr.status) {\n  case ajaxHttpStatus.OK:\n  case ajaxHttpStatus.BAD_REQUEST:\n  case ajaxHttpStatus.NOT_FOUND:\n  case ajaxHttpStatus.CONFLICT:\n  case ajaxHttpStatus.PRECONDITION_FAILED:\n  case ajaxHttpStatus.INTERNAL_SERVER_ERROR: {\n    if (failData.error && ajaxHttpStatus[xhr.status] !== t(appName, failData.error)) {\n      info += ': '\n        + '<span class=\"bold error toastify name\">'\n        + t(appName, failData.error)\n        + '</span>';\n    }\n    const messages = [];\n    if (failData.message) {\n      if (!Array.isArray(failData.message)) {\n        messages.push(failData.message);\n      } else {\n        messages.splice(messages.length, 0, ...failData.message);\n      }\n    }\n    if (failData.messages) {\n      messages.splice(messages.length, 0, ...failData.messages);\n    }\n    if (failData.errorMessages) {\n      messages.splice(messages.length, 0, ...failData.errorMessages);\n    }\n\n    for (const msg of messages) {\n      info += '<div class=\"' + appName + ' error toastify\">' + msg + '</div>';\n    }\n    info += '<div class=\"error toastify feedback-link\">'\n      + t(appName, 'Feedback email: {AutoReport}', { AutoReport: autoReport }, -1, { escape: false })\n      + '</div>';\n    autoReport = '';\n    let exceptionData = failData;\n    if (exceptionData.exception !== undefined) {\n      info += '<div class=\"exception error name\"><pre>' + exceptionData.exception + '</pre></div>'\n        + '<div class=\"exception error trace\"><pre>' + exceptionData.trace + '</pre></div>';\n      while ((exceptionData = exceptionData.previous) != null) {\n        info += '<div class=\"bold error toastify\">' + exceptionData.message + '</div>';\n        info += '<div class=\"exception error name\"><pre>' + exceptionData.exception + '</pre></div>'\n          + '<div class=\"exception error trace\"><pre>' + exceptionData.trace + '</pre></div>';\n      }\n    }\n    if (failData.info) {\n      info += '<div class=\"' + appName + ' error-page\">' + failData.info + '</div>';\n    }\n    break;\n  }\n  case ajaxHttpStatus.UNAUTHORIZED: {\n    // no point in continuing, direct the user to the login page\n    callbacks.cleanup = function() {\n      window.location.replace(cloudWebRoot);\n    };\n\n    let generalHint = t(appName, 'Something went wrong.');\n    generalHint += '<br/>'\n      + t(appName, 'If it should be the case that you are already '\n          + 'logged in for a long time without interacting '\n          + 'with the app, then the reason for this '\n          + 'error is probably a simple timeout.');\n    generalHint += '<br/>'\n      + t(appName, 'In any case it may help to logoff and logon again, as a '\n          + 'temporary workaround. You will be redirected to the '\n          + 'login page when you close this window.');\n    info += '<div class=\"error general\">' + generalHint + '</div>';\n    // info += '<div class=\"error toastify feedback-link\">'\n    //       + t(appName, 'Feedback email: {AutoReport}', { AutoReport: autoReport }, -1, { escape: false })\n    //       + '</div>';\n    break;\n  }\n  }\n\n  // console.info(info);\n  Dialogs.attachDialogHandlers();\n\n  Dialogs.alert(info, caption, function() { callbacks.cleanup(failData); }, true, true);\n  return failData;\n};\n\n/**\n * Generate some diagnostic output, mostly needed during\n * application development. This is intended to be called from the\n * done() callback after a successful AJAX call.\n *\n * @param {object} data The data passed to the callback to $.post()\n *\n * @param {Array} required List of required fields in data.data.\n *\n * @param {Function} errorCB TBD.\n *\n * @return {boolean} TBD.\n */\nconst ajaxValidateResponse = function(data, required, errorCB) {\n  if (data.data && data.data.status !== undefined) {\n    console.error('********** Success handler called as error handler ************');\n    if (data.data.status !== 'success') {\n      ajaxHandleError(null, data, null);\n      return false;\n    } else {\n      data = data.data;\n    }\n  }\n  if (typeof errorCB === 'undefined') {\n    errorCB = function(data) {};\n  }\n  const dialogCallback = function() {\n    errorCB(data);\n  };\n  // error handling\n  if (typeof data === 'undefined' || !data) {\n    Dialogs.alert(\n      t(appName, 'Unrecoverable unknown internal error, no details available'),\n      t(appName, 'Internal Error'), dialogCallback, true);\n    return false;\n  }\n  let missing = '';\n  for (let idx = 0; idx < required.length; ++idx) {\n    if (typeof data[required[idx]] === 'undefined') {\n      missing += t(\n        appName, 'Field {RequiredField} not present in AJAX response.',\n        { RequiredField: required[idx] }) + '<br>';\n    }\n  }\n  if (missing.length > 0) {\n    let info = '';\n    if (typeof data.message !== 'undefined') {\n      info += data.message + ' ';\n    }\n    info += t(appName, 'Missing data');\n    // Add missing fields only if no exception or setup-error was\n    // caught as in this case no regular data-fields have been\n    // constructed\n    info += '<div class=\"missing error\">' + missing + '</div>';\n\n    if (!isPlainObject(data)) {\n      let caption = 'Error';\n      switch (typeof data) {\n      case 'string':\n        info += t(\n          appName,\n          'The submitted data \"{stringValue}\" seems to be a plain string, '\n            + 'but we need an object where the data is provided through above listed properties.',\n          { stringValue: data.substring(0, 32) + '...' });\n        caption = t(appName, 'Error: plain string received');\n        break;\n      default:\n        info += t(\n          appName,\n          'The submitted data is not a plain object, '\n            + 'and does not provide the properties listed above.',\n          { stringValue: data.substring(0, 32) + '...' });\n        caption = t(appName, 'Error: not a plain object');\n        break;\n      }\n      data = { caption, data };\n    }\n\n    // Display additional debug info if any\n    Dialogs.debugPopup(data);\n\n    let caption = data.caption;\n    if (typeof caption === 'undefined' || caption === '') {\n      caption = t(appName, 'Error');\n      data.caption = caption;\n    }\n    Dialogs.alert(info, caption, dialogCallback, true, true);\n    return false;\n  }\n  return true;\n};\n\n/**\n * Fetch data from an error response.\n *\n * @param {object} xhr jqXHR, see fail() method of jQuery ajax.\n *\n * @param {string} textStatus from jQuery, see fail() method of jQuery ajax.\n *\n * @param {string} errorThrown see fail() method of jQuery ajax.\n *\n * @return {object} TBD.\n */\nconst ajaxFailData = function(xhr, textStatus, errorThrown) {\n  if (xhr.parsed !== undefined && xhr.error !== undefined && xhr.status !== undefined && xhr.message !== undefined) {\n    return xhr;\n  }\n  const ct = xhr.getResponseHeader('content-type') || '';\n  let data = {\n    error: errorThrown,\n    status: textStatus,\n    messages: [\n      t(appName, 'Unknown JSON error response to AJAX call: {status} / {error}', { status: textStatus, error: errorThrown }),\n    ],\n    parsed: false,\n  };\n  if (ct.indexOf('html') > -1) {\n    console.debug('html response', xhr, textStatus, errorThrown);\n    console.debug(xhr.status);\n    data.messages = [\n      t(appName, 'HTTP error response to AJAX call: {code} / {error}',\n        { code: xhr.status, error: errorThrown }),\n    ];\n    data.info = $(xhr.responseText).find('main').html();\n    data.parsed = true;\n  } else if (ct.indexOf('json') > -1) {\n    const response = JSON.parse(xhr.responseText);\n    // console.info('XHR response text', xhr.responseText);\n    // console.log('JSON response', response);\n    data = { ...data, ...response };\n    data.parsed = true;\n  } else {\n    console.log('unknown response');\n  }\n  // console.info(data);\n  return data;\n};\n\n/**\n * Generate some diagnostic output, mostly needed during application\n * development.\n *\n * @param {object} xhr jqXHR, see fail() method of jQuery ajax.\n *\n * @param {string} textStatus from jQuery, see fail() method of jQuery ajax.\n *\n * @param {string} errorThrown see fail() method of jQuery ajax.\n *\n * @return {object} TBD.\n */\nconst ajaxFailMessage = function(xhr, textStatus, errorThrown) {\n  return ajaxFailData(xhr, textStatus, errorThrown).message;\n};\n\n$(function() {\n  Dialogs.attachDialogHandlers();\n});\n\nexport {\n  ajaxHttpStatus as httpStatus,\n  ajaxHandleError as handleError,\n  ajaxValidateResponse as validateResponse,\n  ajaxFailData as failData,\n  ajaxFailMessage as failMessage,\n};\n","/**\n * @copyright Copyright (c) 2022, 2023, 2024 Claus-Justus Heine <himself@claus-justus-heine.de>\n *\n * @author Claus-Justus Heine <himself@claus-justus-heine.de>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport $ from './jquery.js';\nimport { appName } from '../../config.js';\nimport generateUrl from './generate-url.js';\nimport * as Ajax from './ajax.js';\nimport * as ncRouter from '@nextcloud/router';\nimport { showError, TOAST_PERMANENT_TIMEOUT } from '@nextcloud/dialogs';\nimport { parse as parseContentDisposition } from 'content-disposition';\n\n/**\n * Place a download request by posting to the given Ajax URL.\n *\n * @param {string} url Relative download url, will be first fed in to\n * generateUrl().\n *\n * @param {Array|boolean} post Optional. Additional post-data.\n *\n * @param {object} options Optional. Success and error callbacks\n * .done(), .fail(), .errorMessage().\n *\n * @return {object} TBD\n */\nconst download = function(url, post, options) {\n  const defaultOptions = {\n    done(url) { console.info('DONE downloading', url); },\n    fail(data) {},\n    always() {},\n    errorMessage(url, data) {\n      const messages = data.messages || [t(appName, 'unknown error')];\n      const message = messages.join(' | ');\n      console.info('ERROR', url, data, message);\n      return t(appName, 'Unable to download data from \"{url}\": {message}', { url, message });\n    },\n  };\n  options = options || {};\n  if (typeof options === 'string') { // error message\n    const errorMessage = options;\n    options = {\n      errorMessage(url, data) {\n        return errorMessage;\n      },\n    };\n  }\n  options = $.extend({}, defaultOptions, options);\n  const fail = options.fail;\n  options.fail = function(data) {\n\n    showError(options.errorMessage(url, data), { timeout: TOAST_PERMANENT_TIMEOUT });\n    fail(data);\n  };\n\n  const method = post ? 'POST' : 'GET';\n  post = post || [];\n  if (!Array.isArray(post) && typeof post === 'object') {\n    const newPost = [];\n    for (const [name, value] of Object.entries(post)) {\n      newPost.push({ name, value });\n    }\n    post = newPost;\n  }\n\n  const downloadUrl = (url.startsWith(ncRouter.generateUrl(''))\n                       || url.startsWith(ncRouter.generateRemoteUrl('')))\n    ? url\n    : generateUrl(url);\n\n  return $.ajax({\n    url: downloadUrl,\n    method,\n    cache: false,\n    data: post,\n    dataType: 'binary', // vital, otherwise jQuery annoyingly tries to parse the response\n    xhr() {\n      const xhr = new XMLHttpRequest();\n      xhr.onreadystatechange = function() {\n        if (xhr.readyState === 2) {\n          if (xhr.status === 200) {\n            xhr.responseType = 'blob';\n          } else {\n            xhr.responseType = 'text';\n          }\n        }\n      };\n      return xhr;\n    },\n  })\n    .fail(function(xhr, status, errorThrown) {\n      Ajax.handleError(xhr, status, errorThrown, options.fail);\n      options.always();\n    })\n    .done(function(data, textStatus, xhr) {\n      let fileName = 'download';\n      const contentDisposition = xhr.getResponseHeader('Content-Disposition');\n      if (contentDisposition) {\n        const contentMeta = parseContentDisposition(contentDisposition);\n        fileName = contentMeta.parameters.filename || fileName;\n      }\n      let contentType = xhr.getResponseHeader('Content-Type');\n      if (contentType) {\n        contentType = contentType.split(';')[0];\n      } else {\n        contentType = 'application/octetstream';\n      }\n\n      // Convert the Byte Data to BLOB object.\n      const blob = new Blob([data], { type: contentType });\n\n      // Check the Browser type and download the File.\n      const isIE = false || !!document.documentMode;\n      if (isIE) {\n        window.navigator.msSaveBlob(blob, fileName);\n      } else {\n        // eslint-disable-next-line n/no-unsupported-features/node-builtins\n        const url = window.URL || window.webkitURL;\n        const link = url.createObjectURL(blob);\n        const a = $('<a />');\n        a.attr('download', fileName);\n        a.attr('href', link);\n        $('body').append(a);\n        a[0].click();\n        console.info('DOWNLOAD A', a);\n        $('body').remove(a);\n      }\n      options.done(downloadUrl, data);\n      options.always();\n    });\n\n};\n\nexport default download;\n","<!--\n - @author Claus-Justus Heine <himself@claus-justus-heine.de>\n - @copyright 2022, 2023, 2024 Claus-Justus Heine\n - @license AGPL-3.0-or-later\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -->\n<template>\n  <div class=\"files-tab\">\n    <ul>\n      <li class=\"files-tab-entry flex flex-center clickable\">\n        <div class=\"files-tab-entry__avatar icon-play-white\"\n             @click.prevent.stop=\"toggleDownloadMenu\"\n        />\n        <div class=\"files-tab-entry__desc\"\n             @click.prevent.stop=\"toggleDownloadMenu\"\n        >\n          <h5>\n            <span class=\"main-title\">{{ t(appName, 'Generate PDF') }}</span>\n          </h5>\n        </div>\n        <NcActions ref=\"downloadActions\">\n          <NcActionButton icon=\"icon-download\"\n                          :disabled=\"downloading\"\n                          @click.prevent.stop=\"handleDownload\"\n          >\n            {{ t(appName, 'download locally') }}\n          </NcActionButton>\n          <NcActionButton :model-value.sync=\"showCloudDestination\"\n                          :disabled=\"showCloudDestination\"\n                          @click.prevent.stop=\"showCloudDestination = !showCloudDestination\"\n          >\n            <template #icon>\n              <CloudUpload :size=\"16\"\n                           decorative\n                           title=\"\"\n              />\n            </template>\n            {{ t(appName, 'save to cloud') }}\n          </NcActionButton>\n        </NcActions>\n      </li>\n      <li v-show=\"showCloudDestination\" class=\"directory-chooser files-tab-entry\">\n        <FilePrefixPicker v-model=\"cloudDestinationFileInfo\"\n                          :hint=\"t(appName, 'Choose a destination in the cloud:')\"\n                          :placeholder=\"t(appName, 'basename')\"\n                          :readonly=\"downloadOptions.useTemplate ? 'basename' : false\"\n                          :disabled=\"downloading\"\n                          @update=\"() => handleSaveToCloud()\"\n        />\n      </li>\n      <li class=\"files-tab-entry flex flex-center clickable\">\n        <div class=\"files-tab-entry__avatar icon-settings-white\"\n             @click=\"toggleOptionsMenu\"\n        />\n        <div class=\"files-tab-entry__desc\"\n             @click=\"toggleOptionsMenu\"\n        >\n          <h5>\n            <span class=\"main-title\">{{ t(appName, 'Options') }}</span>\n          </h5>\n        </div>\n        <NcActions ref=\"downloadOptions\">\n          <NcActionCheckbox v-tooltip=\"tooltips.pageLabels\"\n                            :checked=\"!!downloadOptions.pageLabels\"\n                            @update:checked=\"(value) => downloadOptions.pageLabels = value\"\n          >\n            {{ t(appName, 'page labels') }}\n          </NcActionCheckbox>\n          <NcActionCheckbox v-tooltip=\"tooltips.useTemplate\"\n                            :checked=\"!!downloadOptions.useTemplate\"\n                            @update:checked=\"(value) => downloadOptions.useTemplate = value\"\n          >\n            {{ t(appName, 'filename template') }}\n          </NcActionCheckbox>\n          <NcActionCheckbox v-tooltip=\"tooltips.offline\"\n                            :checked=\"!!downloadOptions.offline\"\n                            @update:checked=\"(value) => downloadOptions.offline = value\"\n          >\n            {{ t(appName, 'offline') }}\n          </NcActionCheckbox>\n        </NcActions>\n      </li>\n      <li class=\"files-tab-entry flex flex-center clickable\">\n        <div class=\"files-tab-entry__avatar icon-download-white\"\n             @click=\"showBackgroundDownloads = !showBackgroundDownloads\"\n        />\n        <div class=\"files-tab-entry__desc\"\n             @click=\"showBackgroundDownloads = !showBackgroundDownloads\"\n        >\n          <h5>{{ t(appName, 'Offline Downloads') }}</h5>\n        </div>\n        <NcActions>\n          <NcActionButton :model-value.sync=\"showBackgroundDownloads\"\n                          :icon=\"'icon-triangle-' + (showBackgroundDownloads ? 'n' : 's')\"\n                          @click.prevent.stop=\"showBackgroundDownloads = !showBackgroundDownloads\"\n          />\n        </NcActions>\n      </li>\n      <li v-show=\"showBackgroundDownloads\" class=\"files-tab-entry\">\n        <div v-if=\"loading\" class=\"icon-loading-small\" />\n        <div v-else-if=\"downloads.length === 0\" class=\"flex flex-center justify-center\">\n          <span class=\"label\">\n            {{ t(appName, 'No Downloads Yet') }}\n          </span>\n          <NcActions>\n            <NcActionButton icon=\"icon-play\"\n                            @click.prevent.stop=\"refreshAvailableDownloads\"\n            >\n              {{ t(appName, 'refresh') }}\n            </NcActionButton>\n          </NcActions>\n        </div>\n        <ul v-else>\n          <li v-for=\"{fileid, basename} in downloads\" :key=\"fileid\" class=\"flex flex-center flex-wrap\">\n            <a :href=\"downloadUrl(fileid)\"\n               class=\"download external flex-grow\"\n               download\n               @click.prevent.stop=\"handleCacheFileDownload(fileid)\"\n            >\n              {{ basename }}\n            </a>\n            <NcActions class=\"flex-no-grow flex-no-shrink\">\n              <NcActionButton @click.prevent.stop=\"handleCacheFileSave(fileid)\">\n                <template #icon>\n                  <CloudUpload :size=\"16\"\n                               decorative\n                               title=\"\"\n                  />\n                </template>\n                {{ t(appName, 'save to cloud') }}\n              </NcActionButton>\n              <NcActionButton icon=\"icon-download\"\n                              :disabled=\"downloading\"\n                              @click.prevent.stop=\"handleCacheFileDownload(fileid)\"\n              >\n                {{ t(appName, 'download locally') }}\n              </NcActionButton>\n              <NcActionButton icon=\"icon-delete\"\n                              :disabled=\"downloading\"\n                              @click.prevent.stop=\"handleCacheFileDelete(fileid)\"\n              >\n                {{ t(appName, 'delete PDF file') }}\n              </NcActionButton>\n            </NcActions>\n          </li>\n        </ul>\n      </li>\n    </ul>\n  </div>\n</template>\n<script>\n\nimport { appName } from '../config.js'\nimport Vue, { set as vueSet } from 'vue'\nimport { getRequestToken } from '@nextcloud/auth'\nimport { emit, subscribe } from '@nextcloud/event-bus'\nimport { fileInfoToNode } from '../toolkit/util/file-node-helper.js'\nimport {\n  NcActions,\n  NcActionButton,\n  NcActionCheckbox,\n  Tooltip,\n} from '@nextcloud/vue'\nimport {\n  // getFilePickerBuilder,\n  FilePickerType,\n  TOAST_PERMANENT_TIMEOUT,\n  showError,\n  showSuccess,\n} from '@nextcloud/dialogs'\nimport CloudUpload from 'vue-material-design-icons/CloudUpload.vue'\nimport axios from '@nextcloud/axios'\nimport { translate as t, translatePlural as n } from '@nextcloud/l10n'\nimport * as Path from 'path'\nimport unclippedPopup from '../components/mixins/unclipped-popup.js'\nimport generateAppUrl from '../toolkit/util/generate-url.js'\nimport { getInitialState } from '../toolkit/services/InitialStateService.js'\nimport fileDownload from '../toolkit/util/file-download.js'\nimport FilePrefixPicker from '@rotdrop/nextcloud-vue-components/lib/components/FilePrefixPicker.vue'\n\nconst initialState = getInitialState()\n\nVue.directive('tooltip', Tooltip)\nVue.mixin({ data() { return { appName } }, methods: { t, n } })\n\nexport {\n  Vue,\n}\n\nexport default {\n  name: 'FilesTab',\n  components: {\n    CloudUpload,\n    FilePrefixPicker,\n    NcActionButton,\n    NcActionCheckbox,\n    NcActions,\n  },\n  mixins: [\n    unclippedPopup,\n  ],\n  data() {\n    return {\n      fileList: undefined,\n      fileInfo: {},\n      folderName: undefined,\n      config: initialState,\n      downloads: [],\n      downloadOptions: {\n        offline: undefined,\n        pageLabels: undefined,\n        useTemplate: true,\n      },\n      showCloudDestination: false,\n      cloudDestinationFileInfo: {\n        dirName: undefined,\n        baseName: undefined,\n      },\n      showBackgroundDownloads: false,\n      activeLoaders: -1,\n      downloading: false,\n      tooltips: {\n        pageLabels: t(appName, 'Decorate each page with the original file name and the page number within that file. The default is configured in the personal preferences for the app.'),\n        offline: t(appName, 'When converting many or large files to PDF you will encounter timeouts because the request just lasts too long and the web server bails out. If this happens you can schedule offline generation of the PDF. This will not make things faster for you, but the execution time is not constrained by the web server limits. You will be notified when it is ready. If you chose to store the PDF in the cloud file system, then it will just show up there. If you chose to download to you local computer then the download will show up here (and in the notification). The download links have a configurable expiration time.'),\n        useTemplate: t(appName, 'Auto-generate the download filename from the given template. The default template can be configured in the personal settings for this app.'),\n      },\n      personalSettings: {},\n    }\n  },\n  computed: {\n    loading() {\n      return this.activeLoaders !== 0\n    },\n    /**\n     * @return {number} The file id of the source file-system object.\n     */\n    sourceFileId() {\n      return this.fileInfo?.id\n    },\n    /**\n     * @return {string} The full path to the source file-system object\n     * (folder or archive file).\n     */\n    sourcePath() {\n      return this.fileInfo.path + (this.fileInfo.path === '/' ? '' : '/') + this.fileInfo.name\n    },\n    cloudDestinationBaseName: {\n      get() {\n        return this.cloudDestinationFileInfo.baseName\n      },\n      set(value) {\n        vueSet(this.cloudDestinationFileInfo, 'baseName', value)\n        return value\n      },\n    },\n    cloudDestinationDirName: {\n      get() {\n        return this.cloudDestinationFileInfo.dirName\n      },\n      set(value) {\n        vueSet(this.cloudDestinationFileInfo, 'dirName', value)\n        return value\n      },\n    },\n    cloudDestinationPathName() {\n      return this.cloudDestinationDirName + (this.cloudDestinationBaseName ? '/' + this.cloudDestinationBaseName : '')\n    },\n  },\n  watch: {\n    showCloudDestination(newValue/*, oldValue */) {\n      if (newValue) {\n        this.$refs.downloadActions.closeMenu()\n      }\n    },\n    downloads(newValue) {\n      this.showBackgroundDownloads = newValue.length > 0\n    },\n  },\n  created() {\n    // this.getData()\n    subscribe('notifications:notification:received', this.onNotification)\n  },\n  mounted() {\n    // this.getData()\n  },\n  methods: {\n    info() {\n      console.info.apply(null, arguments)\n    },\n    setBusySate(/* state */) {\n      // This cannot be used any longer. How to?\n      // this.fileList.showFileBusyState(this.fileInfo.name, state)\n    },\n    /**\n     * Update current fileInfo and fetch new data\n     *\n     * @param {object} fileInfo the current file FileInfo\n     */\n    async update(fileInfo) {\n      this.activeLoaders = 1\n\n      this.fileInfo = fileInfo\n\n      // NOPE, the following is no longer there:\n      // this.fileList = OCA.Files.App.currentFileList\n\n      this.cloudDestinationDirName = this.config.pdfCloudFolderPath || fileInfo.path\n      if (this.fileInfo.type === 'dir') {\n        this.folderName = fileInfo.name\n      } else {\n        // archive file, split the relevant extensions\n        const pathInfo = Path.parse(fileInfo.name)\n        this.folderName = Path.basename(pathInfo.name, '.tar')\n      }\n      this.downloadOptions.pageLabels = this.config.pageLabels\n      this.downloadOptions.offline = this.config.useBackgroundJobsDefault\n\n      this.fetchPdfFileNameFromTemplate(this.sourcePath)\n        .then((value) => {\n          this.cloudDestinationBaseName = value\n        })\n\n      this.refreshAvailableDownloads()\n\n      --this.activeLoaders\n    },\n    /**\n     * Fetch some needed data ...\n     */\n    async getData() {\n      // await this.fetchSettings('personal', this.personalSettings)\n      // vueSet(this.downloadOptions, 'pageLabels', this.personalSettings.pageLabels)\n      // this.downloadOptions.pageLabels = this.personalSettings.pageLabels\n      // this.loading = false\n    },\n    toggleOptionsMenu() {\n      if (this.$refs.downloadOptions.opened) {\n        this.$refs.downloadOptions.closeMenu()\n      } else {\n        this.$refs.downloadOptions.openMenu()\n      }\n    },\n    toggleDownloadMenu() {\n      if (this.$refs.downloadActions.opened) {\n        this.$refs.downloadActions.closeMenu()\n      } else if (this.showCloudDestination) {\n        this.showCloudDestination = false\n      } else {\n        this.$refs.downloadActions.openMenu()\n      }\n    },\n    async fetchPdfFileNameFromTemplate(folderPath) {\n      ++this.activeLoaders\n      try {\n        const response = await axios.get(generateAppUrl(\n          'sample/pdf-filename/{template}/{path}', {\n            template: encodeURIComponent(this.config.pdfFileNameTemplate),\n            path: encodeURIComponent(folderPath),\n          }))\n        --this.activeLoaders\n        return response.data.pdfFileName\n      } catch (e) {\n        let message = t(appName, 'reason unknown')\n        if (e.response && e.response.data) {\n          const responseData = e.response.data\n          if (Array.isArray(responseData.messages)) {\n            message = responseData.messages.join(' ')\n          }\n        }\n        showError(t(appName, 'Unable to obtain the pdf-file template example: {message}', {\n          message,\n        }), {\n          timeout: TOAST_PERMANENT_TIMEOUT,\n        })\n        --this.activeLoaders\n        return undefined\n      }\n    },\n    async refreshAvailableDownloads() {\n      const downloads = await this.fetchAvailableDownloads()\n      this.downloads = downloads\n      this.showBackgroundDownloads = downloads.length > 0\n    },\n    async fetchAvailableDownloads(silent) {\n      if (silent !== true) {\n        ++this.activeLoaders\n      }\n      try {\n        const response = await axios.get(generateAppUrl(\n          'list/{sourcePath}', {\n            sourcePath: encodeURIComponent(this.sourcePath),\n          }))\n        console.info('DOWNLOADS RESPONSE', response)\n        if (silent !== true) {\n          --this.activeLoaders\n        }\n        return response.data\n      } catch (e) {\n        let message = t(appName, 'reason unknown')\n        if (e.response && e.response.data) {\n          const responseData = e.response.data\n          if (Array.isArray(responseData.messages)) {\n            message = responseData.messages.join(' ')\n          }\n        }\n        showError(t(appName, 'Unable to obtain the list of available downloads: {message}', {\n          message,\n        }), {\n          timeout: TOAST_PERMANENT_TIMEOUT,\n        })\n        if (silent !== true) {\n          --this.activeLoaders\n        }\n        return []\n      }\n    },\n    downloadUrl(cacheId) {\n      const sourceFileId = this.sourceFileId\n      return generateAppUrl('download/{sourceFileId}/{cacheId}', {\n        sourceFileId,\n        cacheId,\n        requesttoken: getRequestToken(),\n      })\n    },\n    async handleCacheFileSave(cacheId) {\n      // This cannot work with CopyMove as the promise returned is\n      // resolved with only the path-name, the information about the\n      // chosen mode of operation is not available.\n      //\n      // const picker = getFilePickerBuilder(t(appName, 'Choose a destination'))\n      //   .startAt(this.cloudDestinationDirName)\n      //   .setMultiSelect(false)\n      //   .setModal(true)\n      //   .setType(FilePicker.CopyMove)\n      //   .setMimeTypeFilter(['httpd/unix-directory'])\n      //   .allowDirectories()\n      //   .build()\n      // let dir = await picker.pick()\n\n      // so let's try something which could be a bugfix for @nextcloud/dialogs\n      let { dir, mode } = await new Promise((resolve/*, rej */) => {\n        OC.dialogs.filepicker(\n          t(appName, 'Choose a destination'), // title\n          (dir, mode) => resolve({ dir, mode }), // callback _WITH_ mode\n          false, // multiselect\n          ['httpd/unix-directory'], // mime-types\n          true, // modal\n          FilePickerType.CopyMove, // FilePickerType is not exported\n          this.cloudDestinationDirName, // initial location\n          {\n            allowDirectoryChooser: true,\n          },\n        )\n      })\n      console.info('PATH AND MODE', dir, mode)\n      dir = dir || '/'\n      if (dir.startsWith('//')) { // new in Nextcloud 25?\n        dir = dir.slice(1)\n      }\n      await this.handleSaveToCloud(cacheId, dir, mode === FilePickerType.Move)\n      if (mode === FilePickerType.Move) {\n        const cacheIndex = this.downloads.findIndex((fileInfo) => fileInfo.fileid === cacheId)\n        if (cacheIndex >= 0) {\n          this.downloads.splice(cacheIndex, 1)\n        } else {\n          console.info('DELETED DOWNLOAD ' + cacheId + ' HAS VANISHED FROM DATA?', this.downloads)\n          this.fetchAvailableDownloads().then((downloads) => { this.downloads = downloads })\n        }\n      }\n    },\n    async handleCacheFileDownload(cacheId) {\n      this.downloading = true\n      this.setBusySate(true)\n      fileDownload(this.downloadUrl(cacheId), false, {\n        always: () => {\n          this.downloading = false\n          this.setBusySate(false)\n        },\n      })\n    },\n    async handleCacheFileDelete(cacheId) {\n      this.downloading = true\n      try {\n        const response = await axios.post(generateAppUrl(\n          'clean/{sourcePath}/{cacheId}', {\n            sourcePath: encodeURIComponent(this.sourcePath),\n            cacheId,\n          }))\n        const responseData = response.data\n        if (Array.isArray(responseData.messages)) {\n          for (const message of responseData.messages) {\n            showSuccess(message)\n          }\n        }\n        const cacheIndex = this.downloads.findIndex((fileInfo) => fileInfo.fileid === cacheId)\n        if (cacheIndex >= 0) {\n          this.downloads.splice(cacheIndex, 1)\n        } else {\n          console.info('DELETED DOWNLOAD ' + cacheId + ' HAS VANISHED?', this.downloads)\n          this.fetchAvailableDownloads().then((downloads) => { this.downloads = downloads })\n        }\n      } catch (e) {\n        let message = t(appName, 'reason unknown')\n        if (e.response && e.response.data) {\n          const responseData = e.response.data\n          if (Array.isArray(responseData.messages)) {\n            message = responseData.messages.join(' ')\n          }\n        }\n        showError(t(appName, 'Unable to delete the cached PDF file: {message}', {\n          message,\n        }), {\n          timeout: TOAST_PERMANENT_TIMEOUT,\n        })\n        this.fetchAvailableDownloads().then((downloads) => { this.downloads = downloads })\n      }\n      this.downloading = false\n    },\n    onNotification(event) {\n      const notification = event?.notification\n      if (notification?.app !== appName) {\n        return\n      }\n      const richParameters = notification?.subjectRichParameters\n      if (richParameters.source?.id !== this.sourceFileId) {\n        console.info('*** PDF generation notification for other file received', this.sourceFileId, richParameters)\n        return\n      }\n      const destinationData = richParameters?.destination\n      if (!destinationData) {\n        return\n      }\n      if (destinationData?.status !== 'download' || !destinationData?.file) {\n        console.info('*** PDF generation notification received, but not for for download.', destinationData)\n        return\n      }\n      if (!destinationData?.file) {\n        console.info('*** PDF generation notification received, but carries no file information.', destinationData)\n        return\n      }\n      console.info('*** PDF download generation event received, updating downloads list', destinationData.file)\n      const pdfFile = destinationData.file\n      const pdfFilePath = pdfFile.path // undefined for removal notification\n      const pdfFileId = pdfFile.fileid\n      const downloadsIndex = this.downloads.findIndex((file) => file.fileid === pdfFileId)\n      if (downloadsIndex === -1 && pdfFilePath) {\n        console.info('*** Adding file to list of available downloads.', pdfFile)\n        this.downloads.push(destinationData.file)\n      } else if (downloadsIndex >= 0 && !pdfFilePath) {\n        console.info('*** Removing file from list of available downloads.', pdfFile)\n        this.downloads.splice(downloadsIndex, 1)\n      }\n    },\n    async handleDownload() {\n      this.$refs.downloadActions.closeMenu()\n      this.showCloudDestination = false\n      const urlParameters = {\n        sourceFileId: this.sourceFileId,\n        sourcePath: encodeURIComponent(this.sourcePath),\n        destinationPath: encodeURIComponent(this.cloudDestinationBaseName),\n      }\n      const queryParameters = {\n        pageLabels: this.downloadOptions.pageLabels,\n        useTemplate: this.downloadOptions.useTemplate,\n      }\n      this.downloading = true\n      this.setBusySate(true)\n      if (this.downloadOptions.offline) {\n        try {\n          axios.post(\n            generateAppUrl('schedule/download/{sourcePath}/{destinationPath}', urlParameters),\n            queryParameters,\n          )\n          showSuccess(t(appName, 'Background PDF generation for {sourceFile} has been scheduled.', {\n            sourceFile: this.sourcePath,\n          }))\n        } catch (e) {\n          let message = t(appName, 'reason unknown')\n          if (e.response && e.response.data) {\n            const responseData = e.response.data\n            if (Array.isArray(responseData.messages)) {\n              message = responseData.messages.join(' ')\n            }\n          }\n          showError(t(appName, 'Unable to schedule background PDF generation for {sourceFile}: {message}', {\n            sourceFile: this.sourcePath,\n            message,\n          }), {\n            timeout: TOAST_PERMANENT_TIMEOUT,\n          })\n        }\n        this.downloading = false\n        this.setBusySate(false)\n      } else {\n        const url = generateAppUrl('download/{sourceFileId}', { ...urlParameters, ...queryParameters })\n        fileDownload(url, false, {\n          always: () => {\n            this.downloading = false\n            this.setBusySate(false)\n          },\n        })\n      }\n    },\n    async handleSaveToCloud(cacheFileId, destinationFolder, move) {\n      this.downloading = true\n      this.setBusySate(true)\n      const offline = cacheFileId === undefined && this.downloadOptions.offline\n      let urlTemplate = offline\n        ? 'schedule/filesystem/{sourcePath}/{destinationPath}'\n        : 'save/{sourcePath}/{destinationPath}'\n      const sourcePath = encodeURIComponent(this.sourcePath)\n      const destinationPathName = destinationFolder || this.cloudDestinationPathName\n      const destinationPath = encodeURIComponent(destinationPathName)\n      const requestParameters = {\n        sourcePath,\n        destinationPath,\n      }\n      if (cacheFileId) {\n        urlTemplate += '/{cacheFileId}'\n        requestParameters.cacheFileId = cacheFileId\n      }\n      console.info('TEMPLATE', urlTemplate, requestParameters)\n      try {\n        const response = await axios.post(\n          generateAppUrl(urlTemplate, requestParameters), {\n            pageLabels: this.downloadOptions.pageLabels,\n            useTemplate: this.downloadOptions.useTemplate,\n            move,\n          })\n        if (offline) {\n          showSuccess(t(appName, 'Scheduled offline PDF generation to {path}.', { path: response.data.pdfFilePath }))\n        } else {\n          const pdfFilePath = response.data.pdfFilePath.substring('/files'.length)\n          showSuccess(t(appName, 'PDF saved as {path}.', { path: pdfFilePath }))\n\n          // Emit a birth signal over the event bus. We don't care\n          // whether the new node is located in the currently viewed\n          // directory.\n          const node = fileInfoToNode(response.data.fileInfo)\n          console.info('NODE', node)\n\n          // Update files list\n          emit('files:node:created', node)\n        }\n      } catch (e) {\n        let message = t(appName, 'reason unknown')\n        if (e.response && e.response.data) {\n          const responseData = e.response.data\n          if (Array.isArray(responseData.messages)) {\n            message = responseData.messages.join(' ')\n          }\n        }\n        const notice = t(appName, 'Unable to save the PDF generated from {sourceFile} to the cloud: {message}', {\n          sourceFile: this.sourcePath,\n          message,\n        })\n        showError(notice, { timeout: TOAST_PERMANENT_TIMEOUT })\n        console.error(notice, e)\n      }\n      this.setBusySate(false)\n      this.downloading = false\n    },\n  },\n}\n</script>\n<style lang=\"scss\">\n[csstag=\"vue-tooltip-unclipped-popup\"].v-popper--theme-tooltip {\n  .v-popper__inner {\n    max-width:unset!important;\n  }\n}\n</style>\n<style lang=\"scss\" scoped>\n.files-tab {\n  .flex {\n    display:flex;\n    &.flex-center {\n      align-items:center;\n    }\n    &.flex-wrap {\n      flex-wrap:wrap;\n    }\n    &.justify-center {\n      justify-content: center;\n    }\n    &.flex-wrap {\n      flex-wrap:wrap;\n    }\n    .flex-grow {\n      flex-grow:1;\n    }\n    .flex-no-grow {\n      flex-grow:0;\n    }\n    .flex-no-shrink {\n      flex-shrink:0;\n    }\n  }\n  a.icon {\n    background-position: left;\n    padding-left:20px;\n  }\n  .files-tab-entry {\n    min-height:44px;\n    &.clickable {\n      &, & * {\n        cursor:pointer;\n      }\n    }\n    .files-tab-entry__avatar {\n      width: 32px;\n      height: 32px;\n      line-height: 32px;\n      font-size: 18px;\n      background-color: var(--color-text-maxcontrast);\n      border-radius: 50%;\n      flex-shrink: 0;\n    }\n    .files-tab-entry__desc {\n      flex: 1 1;\n      padding: 8px;\n      line-height: 1.2em;\n      min-width:0;\n      h5 {\n        white-space: nowrap;\n        text-overflow: ellipsis;\n        overflow: hidden;\n        max-width: inherit;\n      }\n    }\n    &.directory-chooser {\n      .dirname {\n        font-weight:bold;\n        font-family:monospace;\n        .button {\n          display:block;\n        }\n      }\n      .label {\n        padding-right:0.5ex;\n      }\n    }\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilesTab.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilesTab.vue?vue&type=script&lang=js\"","/**\n * @copyright Copyright (c) 2024 Claus-Justus Heine <himself@claus-justus-heine.de>\n * @author Claus-Justus Heine <himself@claus-justus-heine.de>\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { getCurrentUser } from '@nextcloud/auth';\nimport { join } from 'path';\nimport { File, Folder } from '@nextcloud/files';\nimport { generateRemoteUrl } from '@nextcloud/router';\n\n/**\n * @param {object} fileInfo File-info object.\n *\n * @param {undefined|string} [owner] If undefined the current user is used.\n *\n * @return {File|Folder}\n */\nexport const fileInfoToNode = function(fileInfo, owner) {\n  owner = owner || getCurrentUser().uid;\n  const userFrontEndFolder = '/' + owner + '/files';\n  if (fileInfo.topLevelFolder !== userFrontEndFolder) {\n    throw new Error(`${fileInfo.path} is located outside of the front end user file space ${userFrontEndFolder}.`);\n  }\n  const nodeData = {\n    id: fileInfo.fileid,\n    source: generateRemoteUrl(join('dav/files', owner, fileInfo.relativePath)),\n    root: `/files/${owner}`,\n    mime: fileInfo.mime,\n    mtime: new Date(fileInfo.lastmod * 1000),\n    owner,\n    size: fileInfo.size,\n    permissions: fileInfo.permissions,\n    attributes: {\n      ...fileInfo,\n      'has-preview': fileInfo.hasPreview,\n    },\n  };\n  return fileInfo.type === 'file' ? new File(nodeData) : new Folder(nodeData);\n};\n","import { render, staticRenderFns } from \"./FilesTab.vue?vue&type=template&id=4a4d4fa2&scoped=true\"\nimport script from \"./FilesTab.vue?vue&type=script&lang=js\"\nexport * from \"./FilesTab.vue?vue&type=script&lang=js\"\nimport style0 from \"./FilesTab.vue?vue&type=style&index=0&id=4a4d4fa2&prod&lang=scss\"\nimport style1 from \"./FilesTab.vue?vue&type=style&index=1&id=4a4d4fa2&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4a4d4fa2\",\n  null\n  \n)\n\nexport default component.exports"],"names":["methods","unclippedPopup","content","html","preventOverflow","csstag","url","urlParams","urlOptions","generated","nextcloudGenerateUrl","appName","queryParams","urlParam","matchAll","queryArray","key","value","Object","entries","push","encodeURIComponent","toString","e","console","debug","length","join","jQuery","require","window","info","fn","jquery","requestToken","getRequestToken","ajaxSetup","beforeSend","xhr","setRequestHeader","onRequestTokenUpdate","token","array","returnVal","maxDepth","undefined","output","d","document","repeatChar","len","padChar","str","i","formatArray","obj","curDepth","padVal","basePad","thickPad","constructor","name","exec","getFuncName","prototype","call","fieldType","body","echo","XULDocument","attachDialogHandlers","container","$container","$","data","off","on","event","toggleClass","stopImmediatePropagation","this","next","nextAll","$this","removeClass","prev","cloudWebRoot","getCloudRootUrl","globalState","getInitialState","ajaxHttpStatus","t","OK","BAD_REQUEST","UNAUTHORIZED","NOT_FOUND","CONFLICT","PRECONDITION_FAILED","INTERNAL_SERVER_ERROR","ajaxHandleError","textStatus","errorThrown","callbacks","defaultCallbacks","cleanup","preProcess","Function","extend","failData","ajaxFailData","decodedStatus","status","caption","autoReport","adminContact","navigator","userAgent","phpUserAgent","print_r","error","messages","message","Array","isArray","splice","errorMessages","msg","AutoReport","escape","exceptionData","exception","trace","previous","location","replace","generalHint","text","title","callback","modal","allowHtml","Dialogs","OC","dialogs","OK_BUTTON","parsed","ct","getResponseHeader","indexOf","code","responseText","find","response","JSON","parse","log","post","options","defaultOptions","done","fail","always","errorMessage","showError","timeout","TOAST_PERMANENT_TIMEOUT","method","newPost","downloadUrl","startsWith","ncRouter","generateUrl","ajax","cache","dataType","XMLHttpRequest","onreadystatechange","readyState","responseType","Ajax","fileName","contentDisposition","parseContentDisposition","parameters","filename","contentType","split","blob","Blob","type","documentMode","msSaveBlob","link","URL","webkitURL","createObjectURL","a","attr","append","click","remove","initialState","Vue","directive","Tooltip","mixin","n","components","CloudUpload","FilePrefixPicker","NcActionButton","NcActionCheckbox","NcActions","mixins","fileList","fileInfo","folderName","config","downloads","downloadOptions","offline","pageLabels","useTemplate","showCloudDestination","cloudDestinationFileInfo","dirName","baseName","showBackgroundDownloads","activeLoaders","downloading","tooltips","personalSettings","computed","loading","sourceFileId","id","sourcePath","path","cloudDestinationBaseName","get","set","vueSet","cloudDestinationDirName","cloudDestinationPathName","watch","newValue","$refs","downloadActions","closeMenu","created","subscribe","onNotification","mounted","apply","arguments","setBusySate","update","pdfCloudFolderPath","pathInfo","Path","useBackgroundJobsDefault","fetchPdfFileNameFromTemplate","then","refreshAvailableDownloads","getData","toggleOptionsMenu","opened","openMenu","toggleDownloadMenu","folderPath","axios","generateAppUrl","template","pdfFileNameTemplate","pdfFileName","responseData","fetchAvailableDownloads","silent","cacheId","requesttoken","handleCacheFileSave","dir","mode","Promise","resolve","filepicker","FilePickerType","CopyMove","allowDirectoryChooser","slice","handleSaveToCloud","Move","cacheIndex","findIndex","fileid","handleCacheFileDownload","fileDownload","handleCacheFileDelete","showSuccess","notification","app","richParameters","subjectRichParameters","source","destinationData","destination","file","pdfFile","pdfFilePath","pdfFileId","downloadsIndex","handleDownload","urlParameters","destinationPath","queryParameters","sourceFile","cacheFileId","destinationFolder","move","urlTemplate","destinationPathName","requestParameters","substring","node","owner","userFrontEndFolder","getCurrentUser","uid","topLevelFolder","Error","nodeData","generateRemoteUrl","relativePath","root","mime","mtime","Date","lastmod","size","permissions","attributes","hasPreview","File","Folder","fileInfoToNode","emit","notice","_vm","_c","_self","staticClass","$event","preventDefault","stopPropagation","_v","_s","ref","attrs","scopedSlots","_u","proxy","directives","rawName","expression","model","$$v","_l","_ref","basename"],"sourceRoot":""}